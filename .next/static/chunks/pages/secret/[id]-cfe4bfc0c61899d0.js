(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[318],{5891:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/secret/[id]",function(){return r(8055)}])},1059:function(e,t,r){"use strict";r.d(t,{Z:function(){return LoginModal}});var a=r(5893),s=r(7294),n=r(7066),o=r(1955),i=r(6893);function LoginModal(e){let{onClose:t,onLogin:r}=e,[l,c]=(0,s.useState)(!0),[d,m]=(0,s.useState)(""),[u,x]=(0,s.useState)(""),[h,p]=(0,s.useState)(!1),[g,y]=(0,s.useState)(!1),[f,b]=(0,s.useState)(""),handleSubmit=async e=>{e.preventDefault(),y(!0),b("");try{let e=l?"https://api.tusecreto.net/api/auth/login":"https://api.tusecreto.net/api/auth/register",t=await n.Z.post(e,{username:d,password:u});o.Z.set("token",t.data.token,{expires:7}),o.Z.set("username",d,{expires:7}),r(d)}catch(e){var t,a;b((null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)||"Error en la autenticaci\xf3n")}finally{y(!1)}};return(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999] p-4",children:(0,a.jsxs)("div",{className:"bg-gray-dark border border-gray-medium rounded-lg p-6 w-full max-w-md",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold flex items-center gap-2",children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i._fJ,{size:24,className:"animate-pulse"}),"Iniciar Sesi\xf3n"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.zy7,{size:24,className:"animate-bounce"}),"Crear Cuenta"]})}),(0,a.jsx)("button",{onClick:t,className:"text-gray-light hover:text-white transition-all duration-300 hover:rotate-90",children:(0,a.jsx)(i.q5L,{size:24})})]}),(0,a.jsxs)("form",{onSubmit:handleSubmit,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium mb-2",children:"Usuario"}),(0,a.jsx)("input",{type:"text",id:"username",value:d,onChange:e=>m(e.target.value),className:"w-full bg-gray-medium border border-gray-light rounded-lg px-3 py-2 text-white placeholder-gray-light focus:outline-none focus:border-white",placeholder:"Ingresa tu usuario",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium mb-2",children:"Contrase\xf1a"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:h?"text":"password",id:"password",value:u,onChange:e=>x(e.target.value),className:"w-full bg-gray-medium border border-gray-light rounded-lg px-3 py-2 pr-10 text-white placeholder-gray-light focus:outline-none focus:border-white",placeholder:"Ingresa tu contrase\xf1a",required:!0}),(0,a.jsx)("button",{type:"button",onClick:()=>p(!h),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-light hover:text-white",children:h?(0,a.jsx)(i.rzC,{size:20}):(0,a.jsx)(i.rDJ,{size:20})})]})]}),f&&(0,a.jsx)("div",{className:"text-red-400 text-sm",children:f}),(0,a.jsx)("button",{type:"submit",disabled:g,className:"w-full bg-white text-black py-2 rounded-lg font-medium hover:bg-gray-200 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 hover:scale-105",children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-black"}),"Cargando..."]}):(0,a.jsx)(a.Fragment,{children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i._fJ,{size:16,className:"group-hover:translate-x-1 transition-transform"}),"Iniciar Sesi\xf3n"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.zy7,{size:16,className:"group-hover:scale-110 transition-transform"}),"Crear Cuenta"]})})})]}),(0,a.jsx)("div",{className:"mt-4 text-center",children:(0,a.jsx)("button",{onClick:()=>c(!l),className:"text-gray-light hover:text-white transition-colors text-sm",children:l?"\xbfNo tienes cuenta? Reg\xedstrate":"\xbfYa tienes cuenta? Inicia sesi\xf3n"})}),(0,a.jsxs)("div",{className:"mt-4 text-xs text-gray-light text-center",children:[(0,a.jsx)("p",{children:"No solicitamos email ni informaci\xf3n personal."}),(0,a.jsx)("p",{children:"Tu anonimato est\xe1 garantizado."})]})]})})}},8055:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return SecretPage}});var a=r(5893),s=r(7294),n=r(1163),o=r(7066),i=r(1955),l=r(6893),c=r(7435),d=r(1059),m=r(4423),u=r(8122);function SecretPage(){let e=(0,n.useRouter)(),{id:t}=e.query,[r,x]=(0,s.useState)(null),[h,p]=(0,s.useState)([]),[g,y]=(0,s.useState)(""),[f,b]=(0,s.useState)(!0),[j,v]=(0,s.useState)(!1),[N,w]=(0,s.useState)(null),[k,C]=(0,s.useState)(!1),[S,Z]=(0,s.useState)(!1),[z,L]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=i.Z.get("token");e&&(w(i.Z.get("username")||null),checkBanStatus())},[]),(0,s.useEffect)(()=>{t&&(fetchSecret(),fetchComments())},[t]);let fetchSecret=async()=>{try{let e=i.Z.get("token"),r=await o.Z.get("/api/secrets/".concat(t),{headers:e?{Authorization:"Bearer ".concat(e)}:{}});x(r.data)}catch(t){console.error("Error fetching secret:",t),e.push("/")}finally{b(!1)}},fetchComments=async()=>{try{let e=await o.Z.get("/api/secrets/".concat(t,"/comments"));p(e.data)}catch(e){console.error("Error fetching comments:",e)}},checkBanStatus=async()=>{try{let e=i.Z.get("token");if(!e)return;let t=await fetch("https://api.tusecreto.net/api/announcements/ban-status",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();e.isBanned&&L(!0)}}catch(e){console.error("Error checking ban status:",e)}},handleLike=async()=>{if(!N){v(!0);return}Z(!0);try{let e=i.Z.get("token");await o.Z.post("/api/secrets/".concat(t,"/like"),{},{headers:{Authorization:"Bearer ".concat(e)}}),fetchSecret()}catch(e){console.error("Error liking secret:",e)}finally{Z(!1)}},handleComment=async e=>{if(e.preventDefault(),!N){v(!0);return}if(g.trim()){C(!0);try{let e=i.Z.get("token");await o.Z.post("/api/secrets/".concat(t,"/comments"),{content:g},{headers:{Authorization:"Bearer ".concat(e)}}),y(""),fetchComments(),fetchSecret()}catch(e){console.error("Error posting comment:",e)}finally{C(!1)}}},handleReport=async()=>{if(!N){v(!0);return}if(confirm("\xbfEst\xe1s seguro de que quieres reportar este secreto?"))try{let e=i.Z.get("token");await o.Z.post("/api/secrets/".concat(t,"/report"),{},{headers:{Authorization:"Bearer ".concat(e)}}),alert("Secreto reportado correctamente")}catch(e){console.error("Error reporting secret:",e),alert("Error al reportar el secreto")}},handleLogout=()=>{i.Z.remove("token"),i.Z.remove("username"),w(null)};return f?(0,a.jsx)(c.Z,{user:N,onLogin:()=>v(!0),onLogout:handleLogout,children:(0,a.jsx)("div",{className:"flex justify-center items-center min-h-[400px]",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2",style:{borderColor:"var(--text-primary)"}})})}):z?(0,a.jsx)(m.Z,{onClose:()=>L(!1)}):r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.Z,{title:r.title,description:"".concat(r.content.substring(0,150),"..."),keywords:"secreto an\xf3nimo, ".concat(r.title,", confesi\xf3n privada, anonimato"),url:"https://secretos.tusecreto.net/secret/".concat(r.id),type:"article",publishedTime:r.createdAt,author:"An\xf3nimo"}),(0,a.jsxs)(c.Z,{user:N,onLogin:()=>v(!0),onLogout:handleLogout,children:[(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,a.jsxs)("button",{onClick:()=>e.push("/"),className:"flex items-center gap-2 transition-colors mb-6",style:{color:"var(--text-secondary)"},children:[(0,a.jsx)(l.Ao2,{size:20}),"Volver a secretos"]}),(0,a.jsxs)("article",{className:"border rounded-lg p-8 mb-8 max-w-full overflow-hidden transition-colors duration-300",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-primary)"},children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-4 break-words",style:{color:"var(--text-primary)"},children:r.title}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 text-sm mb-6",style:{color:"var(--text-secondary)"},children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(l.rDJ,{size:16}),r.views," vistas"]}),(0,a.jsxs)("span",{className:"whitespace-nowrap",children:["por ","admin"===r.author?"admin":"An\xf3nimo"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"hidden sm:inline",children:"â€¢"}),(0,a.jsx)("span",{className:"whitespace-nowrap",children:new Date(r.createdAt).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),(0,a.jsx)("div",{className:"prose max-w-none mb-6 overflow-hidden",children:(0,a.jsx)("p",{className:"text-lg leading-relaxed whitespace-pre-wrap break-words",style:{color:"var(--text-primary)"},children:r.content})}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-6 border-t",style:{borderColor:"var(--border-primary)"},children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("button",{onClick:handleLike,disabled:S,className:"flex items-center gap-2 px-4 py-2 rounded-lg transition-colors",style:{backgroundColor:r.userLiked?"#dc2626":"var(--bg-primary)",color:r.userLiked?"#ffffff":"var(--text-secondary)",border:"1px solid ".concat(r.userLiked?"#dc2626":"var(--border-primary)")},children:[(0,a.jsx)(l.$aX,{size:18,fill:r.userLiked?"currentColor":"none"}),r.likes]}),(0,a.jsxs)("span",{className:"flex items-center gap-2",style:{color:"var(--text-secondary)"},children:[(0,a.jsx)(l.EQ9,{size:18}),h.length," comentarios"]})]}),(0,a.jsxs)("button",{onClick:handleReport,className:"flex items-center gap-2 transition-colors hover:text-red-400",style:{color:"var(--text-secondary)"},children:[(0,a.jsx)(l.MJI,{size:16}),"Reportar"]})]})]}),(0,a.jsxs)("section",{className:"space-y-6",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold",style:{color:"var(--text-primary)"},children:["Comentarios (",h.length,")"]}),N?(0,a.jsxs)("form",{onSubmit:handleComment,className:"border rounded-lg p-6 transition-colors duration-300",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-primary)"},children:[(0,a.jsx)("textarea",{value:g,onChange:e=>y(e.target.value),placeholder:"Escribe tu comentario...",rows:3,className:"w-full border rounded-lg px-3 py-2 focus:outline-none resize-none mb-4 transition-colors duration-300",style:{backgroundColor:"var(--bg-primary)",borderColor:"var(--border-primary)",color:"var(--text-primary)"},maxLength:500}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("span",{className:"text-xs",style:{color:"var(--text-tertiary)"},children:[g.length,"/500 caracteres"]}),(0,a.jsx)("button",{type:"submit",disabled:k||!g.trim(),className:"px-6 py-2 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"var(--accent-primary)",color:"var(--text-on-accent)"},children:k?"Enviando...":"Comentar"})]})]}):(0,a.jsxs)("div",{className:"border rounded-lg p-6 text-center transition-colors duration-300",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-primary)"},children:[(0,a.jsx)("p",{className:"mb-4",style:{color:"var(--text-secondary)"},children:"Inicia sesi\xf3n para comentar"}),(0,a.jsx)("button",{onClick:()=>v(!0),className:"px-6 py-2 rounded-lg font-medium transition-colors",style:{backgroundColor:"var(--accent-primary)",color:"var(--text-on-accent)"},children:"Iniciar Sesi\xf3n"})]}),0===h.length?(0,a.jsxs)("div",{className:"text-center py-8",style:{color:"var(--text-secondary)"},children:[(0,a.jsx)("p",{children:"No hay comentarios a\xfan"}),(0,a.jsx)("p",{className:"text-sm",children:"S\xe9 el primero en comentar"})]}):(0,a.jsx)("div",{className:"space-y-4",children:h.map(e=>(0,a.jsxs)("div",{className:"border rounded-lg p-6 transition-colors duration-300",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-primary)"},children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,a.jsx)("span",{className:"font-medium",style:{color:"var(--text-primary)"},children:"admin"===e.author?"admin":"An\xf3nimo"}),(0,a.jsx)("span",{className:"text-sm",style:{color:"var(--text-tertiary)"},children:new Date(e.createdAt).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,a.jsx)("p",{className:"whitespace-pre-wrap break-words",style:{color:"var(--text-secondary)"},children:e.content})]},e.id))})]})]}),j&&(0,a.jsx)(d.Z,{onClose:()=>v(!1),onLogin:e=>{w(e),v(!1)}})]})]}):(0,a.jsx)(c.Z,{user:N,onLogin:()=>v(!0),onLogout:handleLogout,children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8 text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",style:{color:"var(--text-primary)"},children:"Secreto no encontrado"}),(0,a.jsx)("button",{onClick:()=>e.push("/"),className:"px-6 py-2 rounded-lg font-medium transition-colors",style:{backgroundColor:"var(--accent-primary)",color:"var(--text-on-accent)"},children:"Volver al inicio"})]})})}}},function(e){e.O(0,[415,917,435,869,774,888,179],function(){return e(e.s=5891)}),_N_E=e.O()}]);